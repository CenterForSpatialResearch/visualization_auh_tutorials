<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>In Class</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <script src="https://d3js.org/d3.v5.min.js"></script>

<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v3.1.6/mapbox-gl-geocoder.min.js'></script>
<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v3.1.6/mapbox-gl-geocoder.css' type='text/css' />
<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.0.0/mapbox-gl-directions.js'></script>
<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.0.0/mapbox-gl-directions.css' type='text/css' />
<div id='map'></div>
<style>
body { margin:0; padding:0; }
#map { position:absolute; top:0; bottom:0; width:800px;}
#fly {left:500px;position:absolute;}
</style>
</head>
<body>
<div id='map'></div>
<div id="fly">FLY</div>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoianozMDc3IiwiYSI6ImNqdHczOTkwbDBnOHM0Zm82cXo4anplbXYifQ.x1oWtwpzjoGcuqqh7ME79g';
var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/mapbox/streets-v11',
    center: [-96, 37.8], // starting position
    pitch: 60, // pitch in degrees
    bearing: -80, // bearing in degrees
    zoom: 10 // starting zoom
});

Promise.all([d3.csv("us-cities.csv")])
.then(function(data){
    var cities = data[0]
    
    for(var i in cities){
        var city = cities[i].place
        var lat = cities[i].lat
        var lng = cities[i].lon
        
        d3.select("#fly").append("div").html(city).attr("lat",lat).attr("lng",lng)
        .on("click", function(){
            var lat = d3.select(this).attr("lat")
            var lng = d3.select(this).attr("lng")
            map.flyTo({
                center:[lng,lat],
                zoom:6,
                pitch: 10, // pitch in degrees
                bearing: 30 // bearing in degrees
            })
            
        })
    }


})


//map.scrollZoom.disable();
 
//https://docs.mapbox.com/mapbox-gl-js/example/locate-user/
// Add geolocate control to the map.
map.addControl(new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true
}));
//
//https://docs.mapbox.com/mapbox-gl-js/example/mapbox-gl-geocoder/
//add search
map.addControl(new MapboxGeocoder({
    accessToken: mapboxgl.accessToken
}));


//https://docs.mapbox.com/mapbox-gl-js/example/mapbox-gl-directions/
map.addControl(new MapboxDirections({
accessToken: mapboxgl.accessToken
}), 'top-left');


    
    
    
    



</script>
 
</body>
</html>